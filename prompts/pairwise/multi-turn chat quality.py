def multi_turn_chat_quality(history, prompt, baseline_model_response, response):
    return f"""
# Instruction
You are an expert evaluator. Your task is to compare the quality of responses generated by two AI models (Response A and Response B) in a multi-turn chat setting. You will be presented with the conversation history, the most recent user prompt, and the two AI-generated responses to that prompt.
Carefully review the entire conversation history to understand the context and flow of the dialogue. Then, assess the quality of each response based on the criteria provided in the Evaluation section below.
You will first judge responses individually, following the Rating Rubric and Evaluation Steps. Then you will give step-by-step explanations for your judgment, compare the results, and declare the winner based on the Rating Rubric and Evaluation Steps.

# Evaluation
## Metric Definition
You will be assessing Multi-turn Chat Quality, which measures how effectively the AI-generated response contributes to a meaningful, coherent, and engaging conversation, considering factors like context fluency, groundedness, and conciseness.

## Criteria
Coherence: The response presents ideas in a logical and organized manner, with clear transitions and a consistent focus, making it easy to follow and understand.
Fluency: The text flows smoothly and naturally, adhering to grammatical rules and using appropriate vocabulary.
Instruction following: The response demonstrates a clear understanding of the task instructions, satisfying all of the instruction's requirements.
Groundedness: The response contains information included only in the context. The response does not reference any outside information.
Verbosity: The response is appropriately concise, providing sufficient detail without using complex language to thoroughly address the prompt without being overly wordy or excessively brief.
Collaborativity: The response actively contributes to the conversation by asking relevant follow-up questions, making suggestions, or offering insights when appropriate.
Recall: The response demonstrates a clear understanding of the previous conversation, referencing and utilizing relevant information from earlier turns.

## Rating Rubric
"A": Response A demonstrates significantly better Multi-turn Chat Quality than Response B across multiple criteria, including coherence, fluency, instruction following, groundedness, verbosity, collaborativity, and recall.
"SAME": Response A and Response B demonstrate comparable Multi-turn Chat Quality, with no significant differences across the evaluated criteria.
"B": Response B demonstrates significantly better Multi-turn Chat Quality than Response A across multiple criteria, including coherence, fluency, instruction following, groundedness, verbosity, collaborativity, and recall.

## Evaluation Steps
STEP 1: Carefully review the entire conversation history to gain a comprehensive understanding of the context and flow of the dialogue.
STEP 2: Analyze Response A based on all the Criteria provided. Provide assessment according to each criterion.
STEP 3: Analyze Response B based on all the Criteria provided. Provide assessment according to each criterion.
STEP 4: Compare the overall performance of Response A and Response B based on your analyses and assessment of each criterion
STEP 5: Output your preference of "A", "SAME" or "B" to the pairwise_choice field according to the Rating Rubric.
STEP 6: Output your assessment reasoning in the explanation field, justifying your choice by highlighting the specific strengths and weaknesses of each response in terms of Multi-turn Chat Quality

# User Inputs and AI-generated Responses
## User Inputs

### Conversation History
{history}

### Current User Prompt
{prompt}

# AI-generated Response

### Response A
{baseline_model_response}

### Response B
{response}  // candidate_model_response
"""
